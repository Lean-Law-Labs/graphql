# Default Where

In both of the below cases, comparisons can either be static, or against dynamic fields in either context or JWT.

## Planned work

### Append

The equivalent of the current `where` argument of the `@auth` directive. This is not an authentication or authorization
feature, so we shouldn't make out that it is as such.

#### Directive definition

This will be a "dynamic directive" in a similar fashion to how `@auth` is at the moment, however, it will use types already generated by `makeAugmentedSchema`, rather than defining its own types.

For example, taking the following type as an example:

```gql
type User {
    id: ID!
    name: String!
}
```

This would generate a type:

```gql
type UserWhere {
    id: ID!
    id_NOT: ID!
    ... continues
    name: String!
    name_NOT: String!
    ... continues
}
```

The directive that can be applied to `User` will have the following definition:

```gql
directive @defaultFilter(
    where: UserWhere!
) on OBJECT
```

#### Directive usage

Defines a filter which will always be applied when querying a type. Extra filters can be defined, which will be applied in an `AND` fashion.

Should work consistently with auth fields, for example `THIS CUSTOM FILTER OR roles CONTAINS "admin"`.

WE HAVE AN ISSUE WITH ROLES

```gql
# Winner winner chicken dinner
@defaultFilter(
    where: {     # UserWhere
        OR: [
            { 
            AND: [
                { id: "$jwt.id" }, 
                { admin: false }
            ] 
            }, 
            { admin: true }
        ]
        }
    }
) {
    id: ID!
    name: String!
    admin: Boolean!
}
```

This leaves space for adding in a top-level `operations` field if it is asked for.

## Future work

### Default only

Add an additional argument, which when toggled, adds the default filter to the GraphQL schema rather than into the internal Cypher. This would be overridable, so would be useful in a situation where a library user wants to help their API users get going with queries with sensible filters.

The directive definition could be as follows:

```gql
directive @defaultFilter(
    overridable: Boolean! = false
    where: UserWhere!
) on OBJECT
```

```gql
# Winner winner chicken dinner
@defaultFilter(
    # Nice argument name for this?
    overridable: true,
    where: {     # UserWhere
        OR: [
            { 
            AND: [
                { id: "$jwt.id" }, 
                { admin: false }
            ] 
            }, 
            { admin: true }
        ]
        }
    }
) {
    id: ID!
    name: String!
    admin: Boolean!
}
```

### Specification of operations
